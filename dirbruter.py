import requests
import argparse
import os 

parser = argparse.ArgumentParser(description='Options to scan')
parser.add_argument('url', nargs='?')
parser.add_argument('-d', type=str, required=True, dest='file', help='Dictionary to brute force')
parser.add_argument('-e', nargs='*', dest='exts', help='Extensions to scan')

args = parser.parse_args()

if args.url or args.file is None:
    raise Exception('Wrong!')

dic = open(args.file, "r+")

def file_size(file):
    with open (file) as brute:
        for i, l in enumerate(brute):
            pass
        return i + 1

def enum():
    for i in range(0, file_size(args.file)):
        entry = dic.readline().strip()
        result = args.url+entry if args.url[::-1] == '/' else args.url+'/'+entry
        if args.exts:
            for ext in args.exts:
                result += args.exts
                resp = requests.get(result) 
                if resp.status_code in range(200, 403):
                    print('[+] {} : {}'.format(entry, resp.status_code))
        else:
            resp = requests.get(result) 
            if resp.status_code in range(200, 403):
                print('[+] {} : {}'.format(entry, resp.status_code))
